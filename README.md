# REST API Приложение

Этот проект представляет собой REST API сервис для обработки данных, отправляемых сенсором температуры. API обрабатывает запросы, сохраняет их в базу данных, а также отображает сохраненную в бд информацию.

## Эндпоинты API

### 1. Регистрация сенсора

**Эндпоинт:** `POST /sensors/registration`  
**Описание:** Регистрирует новый сенсор в системе, добавляя его имя в базу данных.  

#### Тело запроса
```json
{
  "name": "Sensor name"
}
```

#### Ответ
- **200 Created**: Сенсор успешно зарегистрирован.
- **400 Bad Request**: Неверный формат запроса.

---

### 2. Добавление измерения

**Эндпоинт:** `POST /measurements/add`  
**Описание:** Добавляет новое измерение, отправленное сенсором, в базу данных. Измерение включает температуру, статус дождя и имя сенсора.  

#### Тело запроса
```json
{
  "value": 24.7,
  "raining": false,
  "sensor": {
    "name": "Sensor name"
  }
}
```

#### Ответ
- **200 Created**: Измерение успешно добавлено.
- **400 Bad Request**: Неверный формат запроса или сенсор не найден.

---

### 3. Получение всех измерений

**Эндпоинт:** `GET /measurements`  
**Описание:** Возвращает все сохранённые измерения из базы данных.  

#### Ответ
- **200 OK**: Возвращает массив измерений в формате JSON.  
  Пример:
  ```json
  [
    {
      "value": 24.7,
      "raining": false,
      "sensor": "Sensor name",
      "timestamp": "2025-01-02T12:00:00Z"
    }
  ]
  ```

---

### 4. Подсчёт дождливых дней

**Эндпоинт:** `GET /measurements/rainyDaysCount`  
**Описание:** Возвращает количество дождливых дней, зарегистрированных в базе данных.  

#### Ответ
- **200 OK**: Возвращает объект JSON.  
  Пример:
  ```json
  {
    "rainyDaysCount": 5
  }
  ```

---

## Мануал

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/TusyaSonne/Project3.git
   ```

2. Создайте базу данных:
   - Создайте БД PostgreSQL
   ```sql
   CREATE DATABASE rest_app_db;

   CREATE TABLE Sensor (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name varchar(30) NOT NULL UNIQUE
   );

   CREATE TABLE Measurement (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    value float NOT NULL,
    raining boolean NOT NULL,
    sensor_id int NOT NULL references sensor(id),
    time_of_measurement TIMESTAMP NOT NULL
   );
   ```

3. Настройте базу данных:
   Отредактируйте файл **application.properties**, введя данные своей БД
   ```
   spring.datasource.driver-class-name=org.postgresql.Driver
   spring.datasource.url=jdbc:postgresql://localhost:5432/rest_app_db
   spring.datasource.username=ВАШ_ЮЗЕРНЕЙМ
   spring.datasource.password=ВАШ_ПАРОЛЬ
   ```

5. Запустите проект через вашу IDE (при разработке проекта использовалась IntelliJ IDEA 2024.1.4 Ultimate Edition).

6. Используйте Postman или Swagger для проверки работоспособности приложения.
  - Все запросы необходимо выполнять по адресу **localhost:8080**.
    - **POST** localhost:8080/sensors/registration;
    - **POST** localhost:8080/measurements/add;
    - **GET** localhost:8080/measurements;
    - **GET** localhost:8080/measurements/rainyDaysCount;
